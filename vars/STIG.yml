## metadata for Audit benchmark
benchmark_version: '1.2.0'
benchmark: RHEL9-STIG

# set to redhat/rocky/alma
rhel9stig_os_distribution: redhat
rpm_gpg_key: /etc/pki/rpm-gpg/RPM-GPG-KEY-RPM-GPG-KEY-redhat-release
gpg_key:
  - name: 'release key 2'
    fingerprint: '567E 347A D004 4ADE 55BA  8A5F 199E 2F91 FD43 1D51'
  - name: 'auxiliary key'
    fingerprint: '6A6A A7C9 7C88 90AE C6AE  BFE2 F76F 66C3 D409 2792'

##rocky example rocky
# rhel9stig_os_distribution: rocky
# rpm_gpg_key: /etc/pki/rpm-gpg/RPM-GPG-KEY-rockyofficial
#gpg_key:
#  - name: 'Release Engineering'
#    fingerprint: '7051 C470 A929 F454 CEBE  37B7 15AF 5DAC 6D74 5A60'

## Alma
# rhel9stig_os_distribution: almalinux
# rpm_gpg_key: /etc/pki/rpm-gpg/RPM-GPG-KEY-AlmaLinux
# gpg_key:
#  - name: 'AlmaLinux'
#    fingerprint: '5E9B 8F56 17B5 066C E920  57C3 488F CF7C 3ABB 34F8'

## Oracle
# rhel9stig_os_distribution: almalinux
# gpg_package: /etc/pki/rpm-gpg/RPM-GPG-KEY-AlmaLinux
# gpg_key:
#  - name: 'AlmaLinux'
#    fingerprint: '5E9B 8F56 17B5 066C E920  57C3 488F CF7C 3ABB 34F8'

# turn the categories on/off
rhel9stig_cat1: true
rhel9stig_cat2: true
rhel9stig_cat3: true

# Some tests may need to scan every filesystem or have an impact on a system
# these may need be scheduled to minimise impact
run_heavy_tests: true
timeout_ms: 120000

# If using the supplied graphical interface
rhel9stig_gui: false

# system acts or requires router networking options
rhel9stig_system_is_router: false

# Assist with skips some audit checks
skip_sssd_check: false
skip_postfix_check: false
skip_tftp_check: false

# Cat 1 rules
#### CAT 1
rhel_09_211010: true
rhel_09_211045: true
rhel_09_211050: true
rhel_09_212020: true
rhel_09_214015: true
rhel_09_214020: true
rhel_09_214025: true
rhel_09_215015: true
rhel_09_215060: true
rhel_09_231190: true
rhel_09_252070: true
rhel_09_252075: true
rhel_09_255040: true
rhel_09_255050: true
rhel_09_271040: true
rhel_09_411100: true
rhel_09_431010: true
rhel_09_611025: true
rhel_09_671010: true
rhel_09_672015: true
rhel_09_672030: true

# Cat 2 rules
rhel_09_211015: true
rhel_09_211020: true
rhel_09_211030: true
rhel_09_211040: true
rhel_09_211055: true
rhel_09_212010: true
rhel_09_212015: true
rhel_09_212025: true
rhel_09_212030: true
rhel_09_212035: true
rhel_09_212040: true
rhel_09_212045: true
rhel_09_213010: true
rhel_09_213015: true
rhel_09_213020: true
rhel_09_213025: true
rhel_09_213030: true
rhel_09_213035: true
rhel_09_213040: true
rhel_09_213045: true
rhel_09_213050: true
rhel_09_213055: true
rhel_09_213060: true
rhel_09_213065: true
rhel_09_213070: true
rhel_09_213075: true
rhel_09_213080: true
rhel_09_213085: true
rhel_09_213090: true
rhel_09_213095: true
rhel_09_213100: true
rhel_09_213105: true
rhel_09_213110: true
rhel_09_213115: true
rhel_09_214010: true
rhel_09_214030: true
rhel_09_215010: true
rhel_09_215020: true
rhel_09_215025: true
rhel_09_215030: true
rhel_09_215035: true
rhel_09_215040: true
rhel_09_215045: true
rhel_09_215050: true
rhel_09_215055: true
rhel_09_215065: true
rhel_09_215070: true
rhel_09_215075: true
rhel_09_215080: true
rhel_09_215085: true
rhel_09_215090: true
rhel_09_215095: true

rhel_09_231010: true
rhel_09_231015: true
rhel_09_231035: true
rhel_09_231040: true
rhel_09_231045: true
rhel_09_231050: true
rhel_09_231055: true
rhel_09_231060: true
rhel_09_231065: true
rhel_09_231070: true
rhel_09_231075: true
rhel_09_231080: true
rhel_09_231085: true
rhel_09_231090: true
rhel_09_231095: true
rhel_09_231100: true
rhel_09_231105: true
rhel_09_231110: true
rhel_09_231115: true
rhel_09_231120: true
rhel_09_231125: true
rhel_09_231130: true
rhel_09_231135: true
rhel_09_231140: true
rhel_09_231145: true
rhel_09_231150: true
rhel_09_231155: true
rhel_09_231160: true
rhel_09_231165: true
rhel_09_231170: true
rhel_09_231175: true
rhel_09_231180: true
rhel_09_231185: true
rhel_09_231200: true
rhel_09_232010: true
rhel_09_232015: true
rhel_09_232020: true
rhel_09_232025: true
rhel_09_232030: true
rhel_09_232035: true
rhel_09_232040: true
rhel_09_232045: true
rhel_09_232050: true
rhel_09_232055: true
rhel_09_232060: true
rhel_09_232065: true
rhel_09_232070: true
rhel_09_232075: true
rhel_09_232080: true
rhel_09_232085: true
rhel_09_232090: true
rhel_09_232095: true
rhel_09_232100: true
rhel_09_232105: true
rhel_09_232110: true
rhel_09_232115: true
rhel_09_232120: true
rhel_09_232125: true
rhel_09_232130: true
rhel_09_232135: true
rhel_09_232140: true
rhel_09_232145: true
rhel_09_232150: true
rhel_09_232155: true
rhel_09_232160: true
rhel_09_232165: true
rhel_09_232170: true
rhel_09_232175: true
rhel_09_232180: true
rhel_09_232185: true
rhel_09_232190: true
rhel_09_232195: true
rhel_09_232200: true
rhel_09_232205: true
rhel_09_232210: true
rhel_09_232215: true
rhel_09_232220: true
rhel_09_232225: true
rhel_09_232230: true
rhel_09_232235: true
rhel_09_232240: true
rhel_09_232245: true
rhel_09_232250: true
rhel_09_232255: true
rhel_09_232260: true
rhel_09_232265: true
rhel_09_232270: true

rhel_09_251010: true
rhel_09_251015: true
rhel_09_251020: true
rhel_09_251025: true
rhel_09_251030: true
rhel_09_251035: true
rhel_09_251040: true
rhel_09_251045: true
rhel_09_252010: true
rhel_09_252015: true
rhel_09_252020: true
rhel_09_252030: true
rhel_09_252035: true
rhel_09_252040: true
rhel_09_252045: true
rhel_09_252050: true
rhel_09_252055: true
rhel_09_252060: true
rhel_09_252065: true
rhel_09_253010: true
rhel_09_253015: true
rhel_09_253020: true
rhel_09_253025: true
rhel_09_253030: true
rhel_09_253035: true
rhel_09_253040: true
rhel_09_253045: true
rhel_09_253050: true
rhel_09_253055: true
rhel_09_253060: true
rhel_09_253065: true
rhel_09_253070: true
rhel_09_253075: true
rhel_09_254010: true
rhel_09_254015: true
rhel_09_254020: true
rhel_09_254025: true
rhel_09_254030: true
rhel_09_254035: true
rhel_09_254040: true
rhel_09_255010: true
rhel_09_255015: true
rhel_09_255020: true
rhel_09_255025: true
rhel_09_255030: true
rhel_09_255035: true
rhel_09_255045: true
rhel_09_255055: true
rhel_09_255060: true
rhel_09_255065: true
rhel_09_255075: true
rhel_09_255080: true
rhel_09_255085: true
rhel_09_255090: true
rhel_09_255095: true
rhel_09_255100: true
rhel_09_255105: true
rhel_09_255110: true
rhel_09_255115: true
rhel_09_255120: true
rhel_09_255125: true
rhel_09_255130: true
rhel_09_255135: true
rhel_09_255140: true
rhel_09_255145: true
rhel_09_255150: true
rhel_09_255155: true
rhel_09_255160: true
rhel_09_255165: true
rhel_09_255170: true
rhel_09_255175: true
rhel_09_271010: true
rhel_09_271015: true
rhel_09_271020: true
rhel_09_271025: true
rhel_09_271030: true
rhel_09_271035: true
rhel_09_271045: true
rhel_09_271050: true
rhel_09_271055: true
rhel_09_271060: true
rhel_09_271065: true
rhel_09_271070: true
rhel_09_271075: true
rhel_09_271080: true
rhel_09_271085: true
rhel_09_271090: true
rhel_09_271100: true
rhel_09_271105: true
rhel_09_271110: true
rhel_09_271115: true

rhel_09_291010: true
rhel_09_291015: true
rhel_09_291020: true
rhel_09_291030: true
rhel_09_291035: true
rhel_09_291040: true

rhel_09_411010: true
rhel_09_411015: true
rhel_09_411020: true
rhel_09_411025: true
rhel_09_411030: true
rhel_09_411035: true
rhel_09_411040: true
rhel_09_411045: true
rhel_09_411050: true
rhel_09_411055: true
rhel_09_411060: true
rhel_09_411065: true
rhel_09_411070: true
rhel_09_411075: true
rhel_09_411080: true
rhel_09_411085: true
rhel_09_411090: true
rhel_09_411095: true
rhel_09_411105: true
rhel_09_411110: true
rhel_09_411115: true

rhel_09_412010: true
rhel_09_412015: true
rhel_09_412020: true
rhel_09_412025: true
rhel_09_412035: true
rhel_09_412045: true
rhel_09_412050: true
rhel_09_412055: true
rhel_09_412060: true
rhel_09_412065: true
rhel_09_412070: true
rhel_09_412080: true
rhel_09_431015: true
rhel_09_431020: true
rhel_09_431025: true
rhel_09_431030: true
rhel_09_432010: true
rhel_09_432015: true
rhel_09_432020: true
rhel_09_432025: true
rhel_09_432030: true
rhel_09_432035: true
rhel_09_433010: true
rhel_09_433015: true

### CAT2 61xxxx
rhel_09_611010: true
rhel_09_611030: true
rhel_09_611035: true
rhel_09_611040: true
rhel_09_611045: true
rhel_09_611050: true
rhel_09_611055: true
rhel_09_611060: true
rhel_09_611065: true
rhel_09_611070: true
rhel_09_611075: true
rhel_09_611080: true
rhel_09_611085: true
rhel_09_611090: true
rhel_09_611095: true
rhel_09_611100: true
rhel_09_611105: true
rhel_09_611110: true
rhel_09_611115: true
rhel_09_611120: true
rhel_09_611125: true
rhel_09_611130: true
rhel_09_611135: true
rhel_09_611140: true
rhel_09_611145: true
rhel_09_611150: true
rhel_09_611155: true
rhel_09_611160: true
rhel_09_611165: true
rhel_09_611170: true
rhel_09_611175: true
rhel_09_611180: true
rhel_09_611185: true
rhel_09_611190: true
rhel_09_611195: true
rhel_09_611200: true
rhel_09_611205: true
### CAT2 63xxxx
rhel_09_631010: true
rhel_09_631015: true
rhel_09_631020: true
### CAT2 65xxxx
rhel_09_651010: true
rhel_09_651015: true
rhel_09_651020: true
rhel_09_651025: true
rhel_09_652010: true
rhel_09_652015: true
rhel_09_652020: true
rhel_09_652025: true
rhel_09_652030: true
rhel_09_653130: true  # NOTE Required before 652035 can run
rhel_09_652035: true
rhel_09_652040: true
rhel_09_652045: true
rhel_09_652050: true
rhel_09_652055: true
rhel_09_652060: true

### CAT2 653xxxx
rhel_09_653010: true
rhel_09_653015: true
rhel_09_653020: true
rhel_09_653025: true
rhel_09_653030: true
rhel_09_653035: true
rhel_09_653040: true
rhel_09_653045: true
rhel_09_653050: true
rhel_09_653055: true
rhel_09_653060: true
rhel_09_653065: true
rhel_09_653070: true
rhel_09_653075: true
rhel_09_653080: true
rhel_09_653085: true
rhel_09_653090: true
rhel_09_653095: true
rhel_09_653100: true
rhel_09_653105: true
rhel_09_653110: true
rhel_09_653115: true
rhel_09_653125: true

### CAT2 654xxxx
rhel_09_654010: true
rhel_09_654015: true
rhel_09_654020: true
rhel_09_654025: true
rhel_09_654030: true
rhel_09_654035: true
rhel_09_654040: true
rhel_09_654045: true
rhel_09_654050: true
rhel_09_654055: true
rhel_09_654060: true
rhel_09_654065: true
rhel_09_654070: true
rhel_09_654075: true
rhel_09_654080: true
rhel_09_654085: true
rhel_09_654090: true
rhel_09_654095: true
rhel_09_654100: true
rhel_09_654105: true
rhel_09_654110: true
rhel_09_654115: true
rhel_09_654120: true
rhel_09_654125: true
rhel_09_654130: true
rhel_09_654135: true
rhel_09_654140: true
rhel_09_654145: true
rhel_09_654150: true
rhel_09_654155: true
rhel_09_654160: true
rhel_09_654165: true
rhel_09_654170: true
rhel_09_654175: true
rhel_09_654180: true
rhel_09_654185: true
rhel_09_654190: true
rhel_09_654195: true
rhel_09_654200: true
rhel_09_654205: true
rhel_09_654210: true
rhel_09_654215: true
rhel_09_654220: true
rhel_09_654225: true
rhel_09_654230: true
rhel_09_654235: true
rhel_09_654240: true
rhel_09_654245: true
rhel_09_654250: true
rhel_09_654255: true
rhel_09_654260: true
rhel_09_654265: true
rhel_09_654270: true
rhel_09_654275: true

rhel_09_671015: true
rhel_09_671020: true
rhel_09_671025: true
rhel_09_672010: true
rhel_09_672020: true
rhel_09_672025: true
rhel_09_672035: true
rhel_09_672040: true
rhel_09_672045: true
rhel_09_672050: true

# Cat 3 controls
rhel_09_211035: true
rhel_09_212050: true
rhel_09_212055: true
rhel_09_214035: true
rhel_09_231020: true
rhel_09_231025: true
rhel_09_231030: true
rhel_09_231195: true
rhel_09_252025: true
rhel_09_291025: true
rhel_09_412030: true
rhel_09_412040: true
rhel_09_412075: true
rhel_09_651030: true
rhel_09_651035: true
rhel_09_653120: true

####

# Variables

# Bootloader Settings
rhel9stig_password_hash: grub.pbkdf2.sha512.changeme
rhel9stig_grub_superuser: root
# Change to true if bios bootlader being used
rhel9stig_legacy_boot: false

## UID:
MIN_UID: 1000
MAX_UID: 65000

rhel9stig_logon_banner:
  - You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.
  - By using this IS (which includes any device attached to this IS), you consent to the following conditions
  - -The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.
  - -At any time, the USG may inspect and seize data stored on this IS.
  - -Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.
  - -This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.
  - -Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.

# Packages and services
rhel9stig_is_ftp_server: false
rhel9stig_is_tftp_server: false
rhel9stig_sendmail_required: false
rhel9stig_nfs_utils_required: false
rhel9stig_ypserv_required: false
rhel9stig_rsh_server_required: false
rhel9stig_telnet_server_required: false
rhel9stig_gssproxy_required: false
rhel9stig_iprutils_required: false
rhel9stig_tuned_required: false
rhel9stig_quagga_required: false

# Threat Protection
rhel9stig_av_pkg: 'mcafeetp'
rhel9stig_av_service: 'mfetpd'

# Filesystem and mount options
rhel9stig_home_filesystem: /home

# Firewall
rhel9stig_white_list_services:
- ssh

# dns
rhel9stig_dns_servers:
- 8.8.8.8
- 8.8.4.4

# Mail
rhel9stig_postfix_client_conf: permit_mynetworks,reject

## SSHD
rhel9stig_sshd_config_file: /etc/ssh/sshd_config
rhel9stig_ssh_required: true
rhel9stig_sshd_config:
  banner_file: /etc/issue
  ciphers:
  - aes256-gcm@openssh.com
#  - chacha20-poly1305@openssh.com  # Removed due to terrapin cve
  - aes256-ctr
  - aes128-gcm@openssh.com
  - aes128-ctr
  clientalivecountmax: 1
  clientaliveinterval: 600  # max 600
  compress: 'no'
  gssapiauth: 'no'
  hostauth: 'no'
  ignoreknownhosts: 'yes'
  ignorerhosts: 'yes'
  include_conf: /etc/ssh/sshd_config.d/*.conf
  kerbauth: 'no'
  lastlog: 'yes'
  loglevel: VERBOSE
  macs:
  - hmac-sha2-256-etm@openssh.com
  - hmac-sha2-256
  - hmac-sha2-512-etm@openssh.com
  - hmac-sha2-512
  pubkeyauth: 'yes'
  permitroot: 'no'
  privsep: sandbox
  rekeylimit: '1G 1h'
  strictmodes: 'yes'
  userenv: 'no'
  x11forward: 'no'
  x11uselocal: 'yes'

## 27XXXX GUI Settings
rhel9stig_dconf_locald_files:
  - /etc/dconf/db/local.d/

rhel9stig_dconf_db: local.d

### ACCOUNTS and AUTH ###
## PAM and password settings
rhel9stig_pass:
  max_days: 60

rhel9stig_user_inactive_days: '35'

# Path to set for users initialization files e.g. echo $PATH expected results
rhel9stig_env_path: '$PATH:$HOME/.local/bin:$HOME/bin'

# Authselect profile settings
rhel9stig_authselect_custom_profile: minimal
# If Set to false will use authselect - Can cause disruption to authentication
rhel9stig_add_faillock_without_authselect: true

# Faillock settings
rhel9stig_faillock:
  deny: '3'  # 3 or less but not 0
  fail_interval: '900'  # 900 or less is required
  unlock_time: '0'
  dir: '/var/log/faillock'

rhel9stig_unnecessary_accounts:
  - ftp
  - games
rhel9stig_remove_unnecessary_user_files: false

rhel9stig_smartcard_reader: false

### Aide
rhel9stig_use_aide: true
rhel9stig_aide_cron_file: /etc/cron.daily/aide  # NOTE the path may change if not running daily
rhel9stig_aide_cron:
  day: '*'
  hour: '4'
  minute: '30'
  job: '/usr/sbin/aide --check | /bin/mail -s "$HOSTNAME - Daily aide integrity check run" root@sysname.mil'
  name: 'Aide Job runs Daily at 0430'

### Rsyslog
# Set the following to true if the server accepts incoming syslog data using rsyslog
rhel9stig_rsyslog_server: false

# Adjust to match remote syslog server configuration
rhel9stig_remotelog_server:
  server: 10.10.10.10
  port: 9999
  protocol: '@@'

### AUDITD
rhel9stig_audit_log_filesystem: /var/log/audit
rhel9stig_audit_conf:
  action_mail_acct: root
  admin_space_left: 5
  admin_space_left_action: single
  disk_error_action: HALT  # Can be one of "SYSLOG", "SINGLE", or "HALT"
  disk_full_action: HALT  # Can be one of "SYSLOG", "SINGLE", or "HALT"
  freq: '100'
  local_events: 'yes'
  log_format: ENRICHED
  logfile: "{{ rhel9stig_audit_log_filesystem }}/audit.log"
  log_group: root
  max_log_file_action: ROTATE
  name_format: hostname
  overflow_action: syslog
  space_left: 25
  space_left_action: email
  write_logs: 'yes'
